Step 1: Create Server-Side Physics Simulation System
Create a new utility file for centralized physics simulations
Port cannonball trajectory calculations from client to this utility
Integrate with the cannon handler
New file and functions to create:

Create new file: api/simulations.py with the following functions:
simulate_projectile(initial_position, initial_velocity, gravity, time_elapsed) - Generic projectile simulation
simulate_cannonball(initial_position, direction, speed, gravity, time_elapsed) - Cannonball-specific simulation
check_collision(projectile_position, target_position, hitbox_size) - Collision detection utility
the check_collision should have some wiggle room because each client has different framerate, and this should give them a bit of leeway
calculate_trajectory_points(initial_position, direction, speed, gravity, duration, steps) - Pre-calculate trajectory
Client-Side Logic To Reference:

cannonshot.js:createCannonball method - Contains the core cannonball trajectory logic
cannonshot.js:cannonballSpeed property - Defines the speed (35)
cannonshot.js:gravity property - Defines gravity (100)
cannonshot.js:animateCannonball function - Contains the physics update logic
Functions to modify:

cannon_handler.py: Enhance handle_cannon_fire to use the simulation utilities
cannon_handler.py: Update update_cannon_positions to call the simulation utilities
Step 2: Server-Side Hit Detection
Use the simulation system to detect collisions between projectiles and players
Broadcast hit events when collisions are detected
Functions to modify:

cannon_handler.py: Integrate check_cannon_collisions with simulation utilities
cannon_handler.py: Update handle_cannon_collision to send damage notifications
cannon_handler.py: Remove or bypass handle_cannon_hit as client reporting is no longer needed
Step 3: Create Centralized Damage Visualization System
Create a new file for centralized damage visualization that can be used by all abilities
Implement common visual effects for player damage
New file and functions to create:

Create new file: src/effects/playerDamageEffects.js
Implement basic damage visualization functions:
showDamageEffect(playerMesh, damageAmount, damageType) - Main function to display damage
showHitFlash(playerMesh) - Visual flash effect on the damaged boat
showDamageNumber(position, amount) - Floating damage number display
showSmokeEffect(playerMesh, intensity) - Smoke effects for damaged boats
Functions to modify:

network.js: Update onCannonHit to use the new centralized damage visualization
network.js: Modify 'cannon_hit' event handler in setupSocketEvents to call the centralized damage system

We already have playerDamageEffects, please as an extra step check that it is valid.